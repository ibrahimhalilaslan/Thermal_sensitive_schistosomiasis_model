# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 5) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 4,  label = paste(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],".0", sep = ""), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
dev.off()
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_mod_compare")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_mod_compare/mansoni_boot_r_not.R")
which.max(r_not_best_mss)
which.max(r_not_best)
max(r_not_best)
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.haematobium/r_not_mod_val_compare")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.haematobium/r_not_mod_val_compare/haematobium_boot_r_not.R")
max(r_not_best)
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.haematobium/mpb_mod_val_compare")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.haematobium/mpb_mod_val_compare/haematobium_plot.R")
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos, color = intensity), size = .2)
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos, color = intensity), size = .2)
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos, color = intensity), size = .2)
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
#geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos, color = intensity), size = .2)
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
sch_heamatobium$bio01
sch_heamatobium$percent_pos
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos), size = .2)
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, 100*prev*max(sch_heamatobium$percent_pos)/max(prev)), size = .1, alpha = 0.5, colour = "blue")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
max(prev)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, 100*prev*max(sch_heamatobium$percent_pos)/max(prev)),d, size = .1, alpha = 0.5, colour = "blue")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos), size = .1, alpha = 0.5, colour = "blue")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos), size = .1, alpha = 0.5, colour = "blue")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
#geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos), size = .1, alpha = 0.5, colour = "blue")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos), size = .1, alpha = 0.5, col = "blue")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, 100*sch_heamatobium$percent_pos*max(percent_positive_best_mpb$percent_positive)/max(sch_heamatobium$percent_pos)), d, size = .1, alpha = 0.5, col = "grey")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
sch_heamatobium$percent_pos
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
#geom_point(aes(sch_heamatobium$bio01, 100*sch_heamatobium$percent_pos*max(percent_positive_best_mpb$percent_positive)/max(sch_heamatobium$percent_pos)), d, size = .1, alpha = 0.5, col = "grey")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(sch_heamatobium$bio01, sch_heamatobium$percent_pos*max(percent_positive_best_mpb$percent_positive)/max(sch_heamatobium$percent_pos)), d, size = .1, alpha = 0.5, col = "grey")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
max(percent_positive_best_mpb$percent_positive)
ch_heamatobium$percent_pos
sch_heamatobium$percent_pos
d_shade <- data.frame(sch_heamatobium$bio01, sch_heamatobium$percent_pos*max(percent_positive_best_mpb$percent_positive)/max(sch_heamatobium$percent_pos))
colnames(d_shade) <- c("shade_emp", "shade_prev")
d_shade <- data.frame(sch_heamatobium$bio01, sch_heamatobium$percent_pos*max(percent_positive_best_mpb$percent_positive)/max(sch_heamatobium$percent_pos))
colnames(d_shade) <- c("shade_temp", "shade_prev")
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, shade_prev), d_shade, size = .1, alpha = 0.5, col = "grey")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
#geom_point(aes(shade_temp, shade_prev), d_shade, size = .1, alpha = 0.5, col = "grey")
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(shade_temp, shade_prev), d_shade, size = .1, alpha = 0.5, col = "grey")
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(shade_temp, shade_prev), d_shade, size = .1, alpha = 0.5, col = "grey")
#geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(shade_temp, shade_prev), d_shade, size = .1, alpha = 0.5, col = "grey")+
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.5, col = "grey")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.5, col = "blue")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "blue")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "blue")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "blue")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 7,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
# plot bootstrapped CIs with data
pdf(file = "conf_haematobium_boot_mpb_shade.pdf", width = 5, height = 5)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "blue")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 7,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
dev.off()
pdf(file = "conf_haematobium_boot_mpb_shade.pdf", width = 5, height = 5)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'blue', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'blue', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "blue") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "blue")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "blue", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "blue", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "blue", size = 1)
dev.off()
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/mpb_mod_compare")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/mpb_mod_compare/mansoni_plot.R")
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "red")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
pdf(file = "conf_mansoni_boot_mpb_shade.pdf", width = 5, height = 5)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "red")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 6) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 5,  label = round(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],1), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
dev.off()
pdf(file = "conf_mansoni_boot_mpb_shade.pdf", width = 5, height = 5)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "red")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 5) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 4,  label = paste(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],".0", sep = ""), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
dev.off()
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "red")+
labs(title = "S.haematobium", x = 'Temperature (ºC)', y = "")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 5) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 4,  label = paste(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],".0", sep = ""), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
labs(title = "S.mansoni", x = 'Temperature (ºC)',y = "Prevalence in human (%)")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5)) +
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 5) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 4,  label = paste(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],".0", sep = ""), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "red")+
labs(title = "S.mansoni", x = 'Temperature (ºC)',y = "Prevalence in human (%)")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5)) +
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 5) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 4,  label = paste(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],".0", sep = ""), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
pdf(file = "conf_mansoni_boot_mpb_shade.pdf", width = 5, height = 5)
ggplot() +
geom_line(aes(temperature,  100*percent_positive), percent_positive_best_mpb, col = 'red', size = 1) +
geom_ribbon(aes(temperature, ymin = 100*percent_positive_lower_bound, ymax = 100*percent_positive_upper_bound), percent_positive_boot_conf_preds, fill = 'red', alpha = 0.1) +
geom_point(aes(temp, 100*prev*max(percent_positive_best_mpb$percent_positive)/max(prev)), d, size = 2, alpha = 0.5, colour = "red") +
geom_point(aes(shade_temp, 100*shade_prev*max(percent_positive_best_mpb$percent_positive)/max(shade_prev)), d_shade, size = .1, alpha = 0.1, col = "red")+
labs(title = "S.mansoni", x = 'Temperature (ºC)',y = "Prevalence in human (%)")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 17),
axis.text.x = element_text(color="black", size=17), axis.text.y = element_text(color="black", size=17),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5)) +
# Add mark segment
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 1, label = '^', colour = "red", size = 5) +
annotate("text", x = percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)], y = 4,  label = paste(percent_positive_best_mpb$temperature[which.max(percent_positive_best_mpb$percent_positive)],".0", sep = ""), colour = "red", size = 5) +
# Add horizontal line segment
geom_segment(aes(x = lower_bound_opt_temp, y = 0.05, xend = upper_bound_opt_temp, yend = 0.05), colour = "red", size = 1)
dev.off()
