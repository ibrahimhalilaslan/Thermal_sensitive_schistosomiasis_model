setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_response_to_parameters")
mydata_long_plot_2
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_response_to_parameters/sensitivity_r_not_to_parameters.R")
ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.5) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = '', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(plot.margin = margin(.25, 2, .25, 1, "cm"), axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="none", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 25),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.5) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(plot.margin = margin(.25, 2, .25, 1, "cm"), axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="none", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 25),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
mydata_long_plot_1 <- ggplot(mydata_long_1, aes(x = x, y = value, color =  values)) +
geom_line(size = 1.5) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression("R"[0]))+
theme(plot.margin = margin(.25, 0, .25, 0, "cm"), axis.title.y = element_text(angle = 90, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 25),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
mydata_long_plot_2 <- ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.5) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(plot.margin = margin(.25, 2, .25, 1, "cm"), axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="none", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 25),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
library(gridExtra)
pdf(file = "combine_sensitivity_parameter_to_r_not.pdf", width = 12, height = 4)
grid.arrange(mydata_long_plot_2, mydata_long_plot_1, ncol = 2, nrow = 1)
dev.off()
library(gridExtra)
pdf(file = "combine_sensitivity_parameter_to_r_not.pdf", width = 12, height = 4)
grid.arrange(mydata_long_plot_2, mydata_long_plot_1, ncol = 2, nrow = 1)
dev.off()
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_response_to_parameters")
mydata_long_plot_1 <- ggplot(mydata_long_1, aes(x = x, y = value, color =  values)) +
geom_line(size = 1.5) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression("R"[0]))+
theme(plot.margin = margin(.25, 0, .25, 0, "cm"), axis.title.y = element_text(angle = 90, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 25),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
mydata_long_plot_2 <- ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.5) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(plot.margin = margin(.25, 2, .25, 1, "cm"), axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="none", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 25),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
library(gridExtra)
pdf(file = "combine_sensitivity_parameter_to_r_not.pdf", width = 12, height = 4)
grid.arrange(mydata_long_plot_2, mydata_long_plot_1, ncol = 2, nrow = 1)
dev.off()
pdf(file = "mansoni_r_not_constant_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_1, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = "S. mansoni", x = 'Temperature (ºC)',y = expression(frac("R"[0], max(("R"[0])))))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"),
panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
dev.off()
pdf(file = "mansoni_r_not_response_to_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
dev.off()
pdf(file = "mansoni_r_not_constant_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_1, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = "S. mansoni", x = 'Temperature (ºC)',y = expression(frac("R"[0], max(("R"[0])))))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"),
panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),
plot.title = element_text(size=25, face="bold.italic", hjust=0.5))
dev.off()
library(tidyr)
pdf(file = "mansoni_r_not_constant_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_1, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = "S. mansoni", x = 'Temperature (ºC)',y = expression(frac("R"[0], max(("R"[0])))))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"),
panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5))
dev.off()
pdf(file = "mansoni_r_not_response_to_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5))
dev.off()
pdf(file = "mansoni_r_not_response_to_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))
dev.off()
pdf(file = "mansoni_r_not_constant_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_1, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = "S. mansoni", x = 'Temperature (ºC)',y = expression(frac("R"[0], max(("R"[0])))))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"),
panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))
dev.off()
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/water_contact")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/water_contact/water_contact_mansoni_mpb.R")
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/water_contact")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/water_contact/water_contact_mansoni_mpb.R")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/water_contact/water_contact_comp.R")
df <- data.frame(x = temperature, y1 = r_not/max(r_not), y2 = r_not_water_contact_1/max(r_not_water_contact_1), y3 = r_not_water_contact_2/max(r_not_water_contact_2),
y4 = probability, y5 = probability_1, y6 = probability_2, y7 = rep(rwct_1(25), length(temperature)), y8 = rwct_1(temperature), y9 = rwct_2(temperature))
r_not_plot <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y1, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = y2, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = y3, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "" , ""),
values = c("", "", "")) +
geom_line(aes(x, r_not/max(r_not)), df, size = 1, colour = "black") +
geom_line(aes(x, r_not_water_contact_1/max(r_not_water_contact_1)), df, size = 1, colour = "red") +
geom_line(aes(x, r_not_water_contact_2/max(r_not_water_contact_2)), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x ='Temperature (ºC)', y = expression("R"[0]/max(("R"[0]))))+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5)) +
annotate("text", x = temperature[which.max(r_not_water_contact_1)], y = 0,
label = '^', colour = "red", size = 7) +
annotate("text", x = temperature[which.max(r_not_water_contact_1)], y = 0.1,
label = temperature[which.max(r_not_water_contact_1)], colour = "red", size = 7)
pdf(file = "r_not_plot.pdf", width = 4, height = 4)
r_not_plot
dev.off()
prevalence_plot <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = 100*y4, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = 100*y5, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = 100*y6, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "" , ""),
values = c("", "", "")) +
geom_line(aes(x, 100*probability), df, size = 1, colour = "black") +
geom_line(aes(x, 100*probability_1), df, size = 1, colour = "red") +
geom_line(aes(x, 100*probability_2), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x = 'Temperature (ºC)', y = 'Prevalence in human (%)')+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5)) +
annotate("text", x = temperature[which.max(probability_1)], y = 1,
label = '^', colour = "red", size = 7) +
annotate("text", x = temperature[which.max(probability_1)], y = 6,
label = paste(temperature[which.max(probability_1)], ".0", sep = ''), colour = "red", size = 7)
pdf(file = "prevalence_plot.pdf", width = 4, height = 4)
prevalence_plot
dev.off()
contact_function <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y7, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = y8, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = y9, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "", ""),
values = c("", "", "")) +
geom_line(aes(x, rep(rwct_1(25), length(temperature))), df, size = 1, colour = "black") +
geom_line(aes(x, rwct_1(temperature)), df, size = 1, colour = "red") +
geom_line(aes(x, rwct_2(temperature)), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = "Water contact rate")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size= 20, face="bold.italic", hjust=0.5) + ylim(0.2, 1.3)) +
annotate("text", x = 13.5, y = 1.35, label = "a = 0.73", colour = "red", size=3.5)+
annotate("text", x = 13.5, y = 1.29, label = "b = 0.28", colour = "red", size=3.5)+
annotate("text", x = 14.5, y = 1.23, label = expression("T"[med]== 23.66), colour = "red", size=3.5)+
annotate("text", x = 21.5, y = 1.35, label = "a = 0.34", colour = "blue", size=3.5)+
annotate("text", x = 21.5, y = 1.29, label = "b = 0.28", colour = "blue", size=3.5)+
annotate("text", x = 22.5, y = 1.23, label = expression("T"[med]== 24.54), colour = "blue", size=3.5)
contact_function
pdf(file = "contact_function.pdf", width = 4, height = 4)
contact_function
dev.off()
library(gridExtra)
pdf(file = "compare_r_not_prevalence_water_cont_rate_mansoni.pdf", width = 12, height = 4)
grid.arrange(contact_function, r_not_plot, prevalence_plot,  ncol = 3, nrow = 1)
dev.off()
prevalence_plot <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = 100*y4, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = 100*y5, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = 100*y6, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "" , ""),
values = c("", "", "")) +
geom_line(aes(x, 100*probability), df, size = 1, colour = "black") +
geom_line(aes(x, 100*probability_1), df, size = 1, colour = "red") +
geom_line(aes(x, 100*probability_2), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x = 'Temperature (ºC)', y = 'Prevalence in human (%)')+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5)) +
annotate("text", x = temperature[which.max(probability_1)], y = 1,
label = '^', colour = "red", size = 7) +
annotate("text", x = temperature[which.max(probability_1)], y = 6,
label = paste(temperature[which.max(probability_1)], ".0", sep = ''), colour = "red", size = 7)
pdf(file = "prevalence_plot.pdf", width = 4, height = 4)
prevalence_plot
dev.off()
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/water_contact/water_contact_comp.R")
contact_function
contact_function <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y7, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = y8, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = y9, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "", ""),
values = c("", "", "")) +
geom_line(aes(x, rep(rwct_1(25), length(temperature))), df, size = 1, colour = "black") +
geom_line(aes(x, rwct_1(temperature)), df, size = 1, colour = "red") +
geom_line(aes(x, rwct_2(temperature)), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = "Water contact rate")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size= 20, face="bold.italic", hjust=0.5) + ylim(0.2, 1.3)) +
annotate("text", x = 13.5, y = 1.35, label = "a = 0.73", colour = "red", size=3.5)+
annotate("text", x = 13.5, y = 1.29, label = "b = 0.28", colour = "red", size=3.5)+
annotate("text", x = 14.5, y = 1.23, label = expression("T"[med]== 23.66), colour = "red", size=3.5)+
annotate("text", x = 21.5, y = 1.35, label = "a = 0.34", colour = "blue", size=3.5)+
annotate("text", x = 21.5, y = 1.29, label = "b = 0.28", colour = "blue", size=3.5)+
annotate("text", x = 22.5, y = 1.23, label = expression("T"[med]== 24.54), colour = "blue", size=3.5)
contact_function
pdf(file = "contact_function.pdf", width = 4, height = 4)
contact_function
dev.off()
contact_function <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y7, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = y8, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = y9, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "", ""),
values = c("", "", "")) +
geom_line(aes(x, rep(rwct_1(25), length(temperature))), df, size = 1, colour = "black") +
geom_line(aes(x, rwct_1(temperature)), df, size = 1, colour = "red") +
geom_line(aes(x, rwct_2(temperature)), df, size = 1, colour = "blue") +
labs(title = '', x = 'Temperature (ºC)',y = "Water contact rate")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size= 20, face="bold.italic", hjust=0.5) + ylim(0.2, 1.3)) +
annotate("text", x = 13.5, y = 1.35, label = "a = 0.73", colour = "red", size=3.5)+
annotate("text", x = 13.5, y = 1.29, label = "b = 0.28", colour = "red", size=3.5)+
annotate("text", x = 14.5, y = 1.23, label = expression("T"[med]== 23.66), colour = "red", size=3.5)+
annotate("text", x = 21.5, y = 1.35, label = "a = 0.34", colour = "blue", size=3.5)+
annotate("text", x = 21.5, y = 1.29, label = "b = 0.28", colour = "blue", size=3.5)+
annotate("text", x = 22.5, y = 1.23, label = expression("T"[med]== 24.54), colour = "blue", size=3.5)
contact_function
pdf(file = "contact_function.pdf", width = 4, height = 4)
contact_function
dev.off()
prevalence_plot <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = 100*y4, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = 100*y5, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = 100*y6, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "" , ""),
values = c("", "", "")) +
geom_line(aes(x, 100*probability), df, size = 1, colour = "black") +
geom_line(aes(x, 100*probability_1), df, size = 1, colour = "red") +
geom_line(aes(x, 100*probability_2), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x = 'Temperature (ºC)', y = 'Prevalence in human (%)')+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5)) +
annotate("text", x = temperature[which.max(probability_1)], y = 1,
label = '^', colour = "red", size = 7) +
annotate("text", x = temperature[which.max(probability_1)], y = 6,
label = paste(temperature[which.max(probability_1)], ".0", sep = ''), colour = "red", size = 7)
pdf(file = "prevalence_plot.pdf", width = 4, height = 4)
prevalence_plot
dev.off()
prevalence_plot
r_not_plot <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y1, colour = "No water contact"), size = 1.5) +
geom_line(aes(y = y2, colour = "Mild water contact"), size = 1.5) +
geom_line(aes(y = y3, colour = "Severe water contact"), size = 1.5) +
scale_colour_manual("",
breaks = c("", "" , ""),
values = c("", "", "")) +
geom_line(aes(x, r_not/max(r_not)), df, size = 1, colour = "black") +
geom_line(aes(x, r_not_water_contact_1/max(r_not_water_contact_1)), df, size = 1, colour = "red") +
geom_line(aes(x, r_not_water_contact_2/max(r_not_water_contact_2)), df, size = 1, colour = "blue") +
labs(title = 'S. mansoni', x ='Temperature (ºC)', y = expression("R"[0]/max(("R"[0]))))+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=20), axis.text.y = element_text(color="black", size=20),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5)) +
annotate("text", x = temperature[which.max(r_not_water_contact_1)], y = 0,
label = '^', colour = "red", size = 7) +
annotate("text", x = temperature[which.max(r_not_water_contact_1)], y = 0.1,
label = temperature[which.max(r_not_water_contact_1)], colour = "red", size = 7)
pdf(file = "r_not_plot.pdf", width = 4, height = 4)
r_not_plot
dev.off()
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_response_to_parameters")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/August_14th_2023_ver_R_script/s.mansoni/r_not_response_to_parameters/sensitivity_r_not_to_parameters.R")
pdf(file = "mansoni_r_not_response_to_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_2, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = 'S. mansoni', x = 'Temperature (ºC)',y = expression(frac("1 dR"[0], "R"[0]*"dT")))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5))
dev.off()
pdf(file = "mansoni_r_not_constant_parameters.pdf", width = 8, height = 5)
ggplot(mydata_long_1, aes(x = x, y = value, color = values)) +
geom_line(size = 1.2) + scale_color_manual(values = custom_colors, name = "Parameters",
labels = parameters) +
labs(title = "S. mansoni", x = 'Temperature (ºC)',y = expression(frac("R"[0], max(("R"[0])))))+
theme(axis.title.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5), legend.position="right", legend.key = element_rect(fill = "white"),
panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 20),
panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text.x = element_text(color="black", size=25), axis.text.y = element_text(color="black", size=25),
plot.title = element_text(size=20, face="bold.italic", hjust=0.5))
dev.off()
