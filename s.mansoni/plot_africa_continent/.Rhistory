fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
library(stars)
ggplot() +
geom_stars(aes(fill = R_not), data = rast) +
scale_color_gradient(low = "white", high = "red", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = expression(paste(italic(S.mansoni) )),
fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = R_not), data = rast) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = expression(paste(italic(S.mansoni) )),
fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
?map_data
africa_map
library(sfheaders)
sessionInfo()
head(africa_map)
x <- sfheaders::sf_mpoly(africa_map, x = "long", y = "lat", polygon_id = group)
?sfheaders::sf_polygon
x <- sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = group)
x <- sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group")
plot(x)
africa_poly <- st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group"))
plot(africa_poly)
unique(world_map$region)
x <- c("Algeria", "Angola", "Benin", "Botswana", "Burkina Faso",
"Burundi", "Cameroon", "Cape Verde", "Central African Republic",
"Chad", "Comoros", "Democratic Republic of the Congo", "Republic of Congo",
"Djibouti", "Egypt", "Equatorial Guinea", "Eritrea", "Eswatini",
"Ethiopia", "Gabon", "Gambia", "Ghana", "Guinea", "Guinea-Bissau",
"Ivory Coast", "Kenya", "Lesotho", "Liberia", "Libya", "Madagascar",
"Malawi", "Mali", "Mauritania", "Mauritius", "Morocco", "Mozambique",
"Namibia", "Niger", "Nigeria", "Rwanda", "Sao Tome and Principe",
"Senegal", "Seychelles", "Sierra Leone", "Somalia", "South Africa",
"South Sudan", "Sudan", "Tanzania", "Togo", "Tunisia", "Uganda",
"Zambia", "Zimbabwe")
y <- unique(world_map$region)
y[!(y %in% x)]
library("plotly")
install.packages("plotly")
head(world_map)
any(grepl("sahara", tolower(y)))
y[any(grepl("sahara", tolower(y)))]
y[(grepl("sahara", tolower(y)))]
# Filter data for Africa
africa_map <- subset(world_map, region %in% c("Algeria", "Angola", "Benin", "Botswana", "Burkina Faso", "Western Sahara",
"Burundi", "Cameroon", "Cape Verde", "Central African Republic",
"Chad", "Comoros", "Democratic Republic of the Congo", "Republic of Congo",
"Djibouti", "Egypt", "Equatorial Guinea", "Eritrea", "Eswatini",
"Ethiopia", "Gabon", "Gambia", "Ghana", "Guinea", "Guinea-Bissau",
"Ivory Coast", "Kenya", "Lesotho", "Liberia", "Libya", "Madagascar",
"Malawi", "Mali", "Mauritania", "Mauritius", "Morocco", "Mozambique",
"Namibia", "Niger", "Nigeria", "Rwanda", "Sao Tome and Principe",
"Senegal", "Seychelles", "Sierra Leone", "Somalia", "South Africa",
"South Sudan", "Sudan", "Tanzania", "Togo", "Tunisia", "Uganda",
"Zambia", "Zimbabwe"))
africa_poly <- st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group"))
plot(africa_poly)
# upload prevalence data
df_africa <- read.csv(file = 'africa_mpb.csv')
df_africa_mask <- read.csv(file = 'africa_mask_v1.csv')
df_africa_mask <- replace_na(complete(df_africa_mask, lon, lat), list(grid_code = 0))
df_africa_r_not <- data.frame(Longitude = df_africa$Longitude, Latitude = df_africa$Latitude,
MAT = df_africa$MAT, R_not = r_not_afun(df_africa$MAT), Rate_of_increase = derivative_r_not_afun(df_africa$MAT))
# Load required libraries
library(maps)
library(ggplot2)
library(sf)
library(tidyr)
library(stars)
library(sfheaders)
# Get world map data
world_map <- map_data("world")
# Filter data for Africa
africa_map <- subset(world_map, region %in% c("Algeria", "Angola", "Benin", "Botswana", "Burkina Faso", "Western Sahara",
"Burundi", "Cameroon", "Cape Verde", "Central African Republic",
"Chad", "Comoros", "Democratic Republic of the Congo", "Republic of Congo",
"Djibouti", "Egypt", "Equatorial Guinea", "Eritrea", "Eswatini",
"Ethiopia", "Gabon", "Gambia", "Ghana", "Guinea", "Guinea-Bissau",
"Ivory Coast", "Kenya", "Lesotho", "Liberia", "Libya", "Madagascar",
"Malawi", "Mali", "Mauritania", "Mauritius", "Morocco", "Mozambique",
"Namibia", "Niger", "Nigeria", "Rwanda", "Sao Tome and Principe",
"Senegal", "Seychelles", "Sierra Leone", "Somalia", "South Africa",
"South Sudan", "Sudan", "Tanzania", "Togo", "Tunisia", "Uganda",
"Zambia", "Zimbabwe"))
africa_poly <- st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group"))
# upload prevalence data
df_africa <- read.csv(file = 'africa_mpb.csv')
df_africa_mask <- read.csv(file = 'africa_mask_v1.csv')
df_africa_mask <- replace_na(complete(df_africa_mask, lon, lat), list(grid_code = 0))
df_africa_r_not <- data.frame(Longitude = df_africa$Longitude, Latitude = df_africa$Latitude,
MAT = df_africa$MAT, R_not = r_not_afun(df_africa$MAT), Rate_of_increase = derivative_r_not_afun(df_africa$MAT))
rast <- st_set_crs(st_as_stars(df_africa_r_not, coords = c("Longitude", "Latitude")), 4326)
mask_rast <- st_set_crs(st_as_stars(df_africa_mask, coords = c("lat", "lon")), 4326)
mask_rast <- st_warp(mask_rast, rast)
rast$R_not[mask_rast$grid_code == 1] <- NA
plot(rast[africa_poly])
africa_poly <- st_set_crs(africa_poly, 4326)
africa_poly <- st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group"))
africa_poly <- st_set_crs(africa_poly, 4326)
# upload prevalence data
df_africa <- read.csv(file = 'africa_mpb.csv')
df_africa_mask <- read.csv(file = 'africa_mask_v1.csv')
df_africa_mask <- replace_na(complete(df_africa_mask, lon, lat), list(grid_code = 0))
df_africa_r_not <- data.frame(Longitude = df_africa$Longitude, Latitude = df_africa$Latitude,
MAT = df_africa$MAT, R_not = r_not_afun(df_africa$MAT), Rate_of_increase = derivative_r_not_afun(df_africa$MAT))
rast <- st_set_crs(st_as_stars(df_africa_r_not, coords = c("Longitude", "Latitude")), 4326)
mask_rast <- st_set_crs(st_as_stars(df_africa_mask, coords = c("lat", "lon")), 4326)
mask_rast <- st_warp(mask_rast, rast)
rast$R_not[mask_rast$grid_code == 1] <- NA
plot(rast[africa_poly])
rast <- rast[africa_poly]
africa_poly <- st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group"))
africa_poly <- st_set_crs(africa_poly, 4326)
# upload prevalence data
df_africa <- read.csv(file = 'africa_mpb.csv')
df_africa_mask <- read.csv(file = 'africa_mask_v1.csv')
df_africa_mask <- replace_na(complete(df_africa_mask, lon, lat), list(grid_code = 0))
df_africa_r_not <- data.frame(Longitude = df_africa$Longitude, Latitude = df_africa$Latitude,
MAT = df_africa$MAT, R_not = r_not_afun(df_africa$MAT), Rate_of_increase = derivative_r_not_afun(df_africa$MAT))
rast <- st_set_crs(st_as_stars(df_africa_r_not, coords = c("Longitude", "Latitude")), 4326)
mask_rast <- st_set_crs(st_as_stars(df_africa_mask, coords = c("lat", "lon")), 4326)
mask_rast <- st_warp(mask_rast, rast)
rast$R_not[mask_rast$grid_code == 1] <- NA
rast <- rast[africa_poly]
library(scales)
ggplot() +
geom_stars(aes(fill = R_not), data = rast) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = expression(paste(italic(S.mansoni) )),
fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
africa_countries <- sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group")
head(africa_map)
africa_countries <- sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "region")
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
mutate(region = ifelse(region == "Western Sahara", "Morocco", region)) %>%
group_by(region) %>% st_union()
library(dplyr)
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
mutate(region = ifelse(region == "Western Sahara", "Morocco", region)) %>%
group_by(region) %>% st_union()
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
mutate(group = ifelse(region == "Western Sahara", "Morocco", region)) %>%
group_by(group) %>% st_union()
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
#mutate(group = ifelse(region == "Western Sahara", "Morocco", region)) %>%
group_by(region) %>% st_union()
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region")
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
st_set_crs(4326) %>% st_make_valid() %>%
mutate(group = ifelse(region == "Western Sahara", "Morocco", region)) %>%
group_by(group) %>% st_union()
africa_countries <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
st_set_crs(4326) %>% st_make_valid()
plot(africa_countries)
?sf_polygon
africa_poly <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
st_set_crs(4326) %>% st_make_valid() %>%
st_union()
africa_poly <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
st_set_crs(4326) %>%
st_union()
africa_poly <- africa_map %>%
sfheaders::sf_polygon(x = "long", y = "lat", polygon_id = "region") %>%
st_union() %>%
st_set_crs(4326)
africa_poly <-  st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "region"))
africa_poly <- st_union(sfheaders::sf_polygon(africa_map, x = "long", y = "lat", polygon_id = "group"))
africa_poly <- st_set_crs(africa_poly, 4326)
ggplot() +
geom_stars(aes(fill = R_not), data = rast) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = expression(paste(italic(S.mansoni) )),
fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_viridis_c(option = "rocket", na.value = "white", direction = -1, begin = .1) +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
?scale_fill_gradient2
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "grey") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "cyan", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "black") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
white
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = R_not), data = rast) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = expression(paste(italic(S.mansoni) )),
fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_colour_gradient2(high = "orange", low = "blue", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "orange", low = "blue", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "blue", low = "orange", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = R_not), data = rast) +
scale_fill_gradient(low = "white", high = "red", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = expression(paste(italic(S.mansoni) )),
fill = expression(paste(R[0]))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title =  element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
rast$Rate_of_increase[mask_rast$grid_code == 1] <- NA
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "blue", low = "orange", mid = "grey", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "#1E90FF", low = "orange", mid = "grey", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "#1E90FF", low = "orange", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(high = "#1E90FF", low = "#FC6A03", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(low = "#1E90FF", high = "#FC6A03", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(low = "#123456", high = "#FC6A03", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
dev.off()
pdf(file = "s_mansoni_africa_continent_MAT.pdf", width = 8, height = 8)
1E90FF
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(low = "#1E90FF", high = "#FC6A03", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
ggplot() +
geom_stars(aes(fill = Rate_of_increase), data = rast) +
scale_fill_gradient2(low = "#1E90FF", high = "#FC6A03", mid = "white", na.value = "white") +
geom_map(data = africa_map, map = africa_map,
aes(map_id = region),
fill = NA, color = "black", size = 0.5) +
labs(title = "",
fill =  expression(frac("dR"[0], dT))) +  # Add title and color legend title
theme_void() +
coord_sf() +
theme(  # Adjust plot margins
plot.title = element_text(hjust = 0.5, face = "bold", size = 27),
legend.position = c(0.3, 0.2)) # Center plot title
