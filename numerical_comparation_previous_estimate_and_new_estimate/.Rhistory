type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_applet_77,  rate_applet_77, col = 2, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_has_74_a,  rate_has_74_a, col = 3, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_sturr_66,  rate_sturr_66, col = 4, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_foster_64,  rate_foster_64, col = 5, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_mccreesh_14,  rate_mccreesh_14, col = 6, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_eleman_82,  rate_eleman_82, col = 7, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_shiff_63,  rate_shiff_63, col = 8, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
mtext(text = expression(paste("Temperature (",degree,"C)")), side = 1, line = 2.5, cex = 1.5)
mtext(text = "Mortality rate of snails per day", side = 2, line = 2.5, cex = 1.5)
#main = "Death rate of snail per day", cex.main=1.7
dev.off()
pdf(file = "mortality_rate_snail.pdf", width = 5, height = 5)
par(mar=c(4, 4, 8, 1), xpd = TRUE)
plot(temperature, preds, col = 1,  pch = 21, lwd = 3, ylab = "",  xlab = "", cex.lab = 1.3, type = "l", cex.axis=1.3,
xlim = c(min(temperature), max(temperature)), ylim = c(-1, max(preds)+1))
text(temperature[which.min(preds)],   -0.8,     labels = "^", cex = 1.5, col = 1)
text(temperature[which.min(preds)],    -0.4,     labels = round(temperature[which.min(preds)],3), cex = 1.5, col = 1)
points(temp_applet_77, rate_applet_77, col = 2, pch = 19)
points(c(temp_has_74_a, temp_has_74_a_h), c(rate_has_74_a, temp_has_74_a_h), col = 3, pch = 19)
points(temp_sturr_66, rate_sturr_66, col = 4, pch = 19)
points(temp_foster_64, rate_foster_64, col = 5, pch = 19)
points(temp_joubert_86_p, rate_joubert_86_p, col = 6, pch = 19)
points(temp_mccreesh_14, rate_mccreesh_14, col = 7, pch = 19)
points(temp_eleman_82, rate_eleman_82, col = 8, pch = 19)
points(temp_shiff_63, rate_shiff_63, col = 9, pch = 19)
legend("bottomleft", inset=c(0, 1.01), legend=c(expression(paste(italic('B. pfeifferi,'), "  C. C. APPLETON, 1977")), expression(paste(italic('B. alexandrina,'), "  A. A. EL-HASSAN, 1974")),
expression(paste(italic('B. pfeifferi,'), "  R. F. Sturrock, 1966")), expression(paste(italic('B. pfeifferi,'), "  R. Foster, 1964")),
expression(paste(italic('B. pfeifferi,'), "  Shiff and Garnett 1963")),
expression(paste(italic('B. sudanica,'), "  McCreesh et al., 2014")),
expression(paste(italic('B. alexandrina,'), "  El-Emam and Madsen, 1982"))),                                           expression(paste(italic('B. pfeifferi'), "  Shiff and Garnett,  1963")),
pch = 19, col = c(2,  3,  4,  5, 6, 7, 8, 9), title="Data", cex = .8)
v <- c(which(temperature == 10):which(temperature == 30))
subplot(
plot(temperature[v], preds[v],
lwd = 3, type = "l", cex.axis = .7, ylim = c(0, 0.035), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_applet_77,  rate_applet_77, col = 2, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_has_74_a,  rate_has_74_a, col = 3, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_sturr_66,  rate_sturr_66, col = 4, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_foster_64,  rate_foster_64, col = 5, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_mccreesh_14,  rate_mccreesh_14, col = 6, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_eleman_82,  rate_eleman_82, col = 7, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_shiff_63,  rate_shiff_63, col = 8, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
mtext(text = expression(paste("Temperature (",degree,"C)")), side = 1, line = 2.5, cex = 1.5)
mtext(text = "Mortality rate of snails per day", side = 2, line = 2.5, cex = 1.5)
#main = "Death rate of snail per day", cex.main=1.7
dev.off()
dev.off()
dev.off()
pdf(file = "mortality_rate_snail.pdf", width = 5, height = 5)
par(mar=c(4, 4, 8, 1), xpd = TRUE)
plot(temperature, preds, col = 1,  pch = 21, lwd = 3, ylab = "",  xlab = "", cex.lab = 1.3, type = "l", cex.axis=1.3,
xlim = c(min(temperature), max(temperature)), ylim = c(-1, max(preds)+1))
text(temperature[which.min(preds)],   -0.8,     labels = "^", cex = 1.5, col = 1)
text(temperature[which.min(preds)],    -0.4,     labels = round(temperature[which.min(preds)],3), cex = 1.5, col = 1)
points(temp_applet_77, rate_applet_77, col = 2, pch = 19)
points(c(temp_has_74_a, temp_has_74_a_h), c(rate_has_74_a, temp_has_74_a_h), col = 3, pch = 19)
points(temp_sturr_66, rate_sturr_66, col = 4, pch = 19)
points(temp_foster_64, rate_foster_64, col = 5, pch = 19)
points(temp_joubert_86_p, rate_joubert_86_p, col = 6, pch = 19)
points(temp_mccreesh_14, rate_mccreesh_14, col = 7, pch = 19)
points(temp_eleman_82, rate_eleman_82, col = 8, pch = 19)
points(temp_shiff_63, rate_shiff_63, col = 9, pch = 19)
legend("bottomleft", inset=c(0, 1.01), legend=c(expression(paste(italic('B. pfeifferi,'), "  C. C. APPLETON, 1977")), expression(paste(italic('B. alexandrina,'), "  A. A. EL-HASSAN, 1974")),
expression(paste(italic('B. pfeifferi,'), "  R. F. Sturrock, 1966")), expression(paste(italic('B. pfeifferi,'), "  R. Foster, 1964")),
expression(paste(italic('B. pfeifferi,'), "  Shiff and Garnett 1963")),
expression(paste(italic('B. sudanica,'), "  McCreesh et al., 2014")),
expression(paste(italic('B. alexandrina,'), "  El-Emam and Madsen, 1982"))),                                           expression(paste(italic('B. pfeifferi'), "  Shiff and Garnett,  1963")),
pch = 19, col = c(2,  3,  4,  5, 6, 7, 8, 9), title="Data", cex = .8)
v <- c(which(temperature == 10):which(temperature == 30))
subplot(
plot(temperature[v], preds[v],
lwd = 3, type = "l", cex.axis = .7, ylim = c(0, 0.035), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_applet_77,  rate_applet_77, col = 2, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_has_74_a,  rate_has_74_a, col = 3, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_sturr_66,  rate_sturr_66, col = 4, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_foster_64,  rate_foster_64, col = 5, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_mccreesh_14,  rate_mccreesh_14, col = 6, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_eleman_82,  rate_eleman_82, col = 7, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_shiff_63,  rate_shiff_63, col = 8, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
mtext(text = expression(paste("Temperature (",degree,"C)")), side = 1, line = 2.5, cex = 1.5)
mtext(text = "Mortality rate of snails per day", side = 2, line = 2.5, cex = 1.5)
#main = "Death rate of snail per day", cex.main=1.7
dev.off()
library(TeachingDemos)
install.packages("TeachingDemos")
library(TeachingDemos)
pdf(file = "mortality_rate_snail.pdf", width = 5, height = 5)
par(mar=c(4, 4, 8, 1), xpd = TRUE)
plot(temperature, preds, col = 1,  pch = 21, lwd = 3, ylab = "",  xlab = "", cex.lab = 1.3, type = "l", cex.axis=1.3,
xlim = c(min(temperature), max(temperature)), ylim = c(-1, max(preds)+1))
text(temperature[which.min(preds)],   -0.8,     labels = "^", cex = 1.5, col = 1)
text(temperature[which.min(preds)],    -0.4,     labels = round(temperature[which.min(preds)],3), cex = 1.5, col = 1)
points(temp_applet_77, rate_applet_77, col = 2, pch = 19)
points(c(temp_has_74_a, temp_has_74_a_h), c(rate_has_74_a, temp_has_74_a_h), col = 3, pch = 19)
points(temp_sturr_66, rate_sturr_66, col = 4, pch = 19)
points(temp_foster_64, rate_foster_64, col = 5, pch = 19)
points(temp_joubert_86_p, rate_joubert_86_p, col = 6, pch = 19)
points(temp_mccreesh_14, rate_mccreesh_14, col = 7, pch = 19)
points(temp_eleman_82, rate_eleman_82, col = 8, pch = 19)
points(temp_shiff_63, rate_shiff_63, col = 9, pch = 19)
legend("bottomleft", inset=c(0, 1.01), legend=c(expression(paste(italic('B. pfeifferi,'), "  C. C. APPLETON, 1977")), expression(paste(italic('B. alexandrina,'), "  A. A. EL-HASSAN, 1974")),
expression(paste(italic('B. pfeifferi,'), "  R. F. Sturrock, 1966")), expression(paste(italic('B. pfeifferi,'), "  R. Foster, 1964")),
expression(paste(italic('B. pfeifferi,'), "  Shiff and Garnett 1963")),
expression(paste(italic('B. sudanica,'), "  McCreesh et al., 2014")),
expression(paste(italic('B. alexandrina,'), "  El-Emam and Madsen, 1982"))),                                           expression(paste(italic('B. pfeifferi'), "  Shiff and Garnett,  1963")),
pch = 19, col = c(2,  3,  4,  5, 6, 7, 8, 9), title="Data", cex = .8)
v <- c(which(temperature == 10):which(temperature == 30))
subplot(
plot(temperature[v], preds[v],
lwd = 3, type = "l", cex.axis = .7, ylim = c(0, 0.035), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_applet_77,  rate_applet_77, col = 2, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_has_74_a,  rate_has_74_a, col = 3, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_sturr_66,  rate_sturr_66, col = 4, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_foster_64,  rate_foster_64, col = 5, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_mccreesh_14,  rate_mccreesh_14, col = 6, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_eleman_82,  rate_eleman_82, col = 7, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_shiff_63,  rate_shiff_63, col = 8, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
mtext(text = expression(paste("Temperature (",degree,"C)")), side = 1, line = 2.5, cex = 1.5)
mtext(text = "Mortality rate of snails per day", side = 2, line = 2.5, cex = 1.5)
#main = "Death rate of snail per day", cex.main=1.7
dev.off()
dev.off()
dev.off()
library(TeachingDemos)
pdf(file = "mortality_rate_snail.pdf", width = 5, height = 5)
par(mar=c(4, 4, 8, 1), xpd = TRUE)
plot(temperature, preds, col = 1,  pch = 21, lwd = 3, ylab = "",  xlab = "", cex.lab = 1.3, type = "l", cex.axis=1.3,
xlim = c(min(temperature), max(temperature)), ylim = c(-1, max(preds)+1))
text(temperature[which.min(preds)],   -0.8,     labels = "^", cex = 1.5, col = 1)
text(temperature[which.min(preds)],    -0.4,     labels = round(temperature[which.min(preds)],3), cex = 1.5, col = 1)
points(temp_applet_77, rate_applet_77, col = 2, pch = 19)
points(c(temp_has_74_a, temp_has_74_a_h), c(rate_has_74_a, temp_has_74_a_h), col = 3, pch = 19)
points(temp_sturr_66, rate_sturr_66, col = 4, pch = 19)
points(temp_foster_64, rate_foster_64, col = 5, pch = 19)
points(temp_joubert_86_p, rate_joubert_86_p, col = 6, pch = 19)
points(temp_mccreesh_14, rate_mccreesh_14, col = 7, pch = 19)
points(temp_eleman_82, rate_eleman_82, col = 8, pch = 19)
points(temp_shiff_63, rate_shiff_63, col = 9, pch = 19)
legend("bottomleft", inset=c(0, 1.01), legend=c(expression(paste(italic('B. pfeifferi,'), "  C. C. APPLETON, 1977")), expression(paste(italic('B. alexandrina,'), "  A. A. EL-HASSAN, 1974")),
expression(paste(italic('B. pfeifferi,'), "  R. F. Sturrock, 1966")), expression(paste(italic('B. pfeifferi,'), "  R. Foster, 1964")),
expression(paste(italic('B. pfeifferi,'), "  Shiff and Garnett 1963")),
expression(paste(italic('B. sudanica,'), "  McCreesh et al., 2014")),
expression(paste(italic('B. alexandrina,'), "  El-Emam and Madsen, 1982"))),                                           expression(paste(italic('B. pfeifferi'), "  Shiff and Garnett,  1963")),
pch = 19, col = c(2,  3,  4,  5, 6, 7, 8, 9), title="Data", cex = .8)
v <- c(which(temperature == 10):which(temperature == 30))
subplot(
plot(temperature[v], preds[v],
lwd = 3, type = "l", cex.axis = .7, ylim = c(0, 0.035), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_applet_77,  rate_applet_77, col = 2, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_has_74_a,  rate_has_74_a, col = 3, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_sturr_66,  rate_sturr_66, col = 4, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_foster_64,  rate_foster_64, col = 5, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_mccreesh_14,  rate_mccreesh_14, col = 6, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_eleman_82,  rate_eleman_82, col = 7, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
subplot(
plot(temp_shiff_63,  rate_shiff_63, col = 8, pch = 19, axes = FALSE, ylim = c(0, 0.03), xlim = c(9, 32)),
x  = grconvertX(c(.25,1), from='npc'),
y = grconvertY(c(.25, 1), from='npc'),
type='fig', pars=list(mar=c(3,0,.5,3)+.2),
)
mtext(text = expression(paste("Temperature (",degree,"C)")), side = 1, line = 2.5, cex = 1.5)
mtext(text = "Mortality rate of snails per day", side = 2, line = 2.5, cex = 1.5)
#main = "Death rate of snail per day", cex.main=1.7
dev.off()
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/ther_sen_par_biom_mansoni")
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.haematobium/ther_sen_par_bul_haemtobium")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.haematobium/ther_sen_par_bul_haemtobium/fec_rate_snail_sel_mod.R")
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/ther_sen_par_biom_mansoni")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/ther_sen_par_biom_mansoni/lat_per_snail_sel_mod.R")
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/ther_sen_par_biom_mansoni")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/ther_sen_par_biom_mansoni/fec_rate_snail_sel_mod.R")
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/water_contact")
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/water_contact")
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/water_contact/water_contact_comp.R")
pdf(file = "contact_function.pdf", width = 4, height = 4)
contact_function
dev.off()
pdf(file = "contact_function.pdf", width = 4, height = 4)
contact_function
dev.off()
pdf(file = "r_not_plot.pdf", width = 4, height = 4)
r_not_plot
dev.off()
pdf(file = "prevalence_plot", width = 4, height = 4)
prevalence_plot
dev.off()
pdf(file = "prevalence_plot", width = 4, height = 4)
prevalence_plot
dev.off()
pdf(file = "prevalence_plot.pdf", width = 4, height = 4)
prevalence_plot
dev.off()
contact_function
contact_function <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y7, colour = "No water contact"), size = 1) +
geom_line(aes(y = y8, colour = "Mild water contact"), size = 1) +
geom_line(aes(y = y9, colour = "Severe water contact"), size = 1) +
scale_colour_manual("",
breaks = c("", "", ""),
values = c("", "", "")) +
geom_line(aes(x, rep(rwct_1(25), length(temperature))), df, size = 1, colour = "red") +
geom_line(aes(x, rwct_1(temperature)), df, size = 1, colour = "green") +
geom_line(aes(x, rwct_2(temperature)), df, size = 1, colour = "orange") +
labs(title = '', x = 'Temperature (ºC)',y = "Water contact rate")+
theme(legend.position="bottom", legend.key = element_rect(fill = "red"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 12),
axis.text.x = element_text(color="black", size=12), axis.text.y = element_text(color="black", size=12),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))
contact_function
contact_function <- ggplot(data = df, aes(x = x)) +
geom_line(aes(y = y7, colour = "No water contact"), size = 1) +
geom_line(aes(y = y8, colour = "Mild water contact"), size = 1) +
geom_line(aes(y = y9, colour = "Severe water contact"), size = 1) +
scale_colour_manual("",
breaks = c("", "", ""),
values = c("", "", "")) +
geom_line(aes(x, rep(rwct_1(25), length(temperature))), df, size = 1, colour = "red") +
geom_line(aes(x, rwct_1(temperature)), df, size = 1, colour = "green") +
geom_line(aes(x, rwct_2(temperature)), df, size = 1, colour = "orange") +
labs(title = '', x = 'Temperature (ºC)',y = "Water contact rate")+
theme(legend.position="bottom", legend.key = element_rect(fill = "white"), panel.background = element_rect(fill = "white", colour = "black"), text = element_text(size = 12),
axis.text.x = element_text(color="black", size=12), axis.text.y = element_text(color="black", size=12),  panel.border = element_rect(colour = "black", fill=NA, size=1),
plot.title = element_text(size=14, face="bold.italic", hjust=0.5))+
annotate("text", x = 10, y = 1.2, label = "Your Text Here")
contact_function
Tmed_1
a_1
c
Tmed_2
a_2
# our parameter values as disease control strategies.
prev_percent <- read.csv(file = 'gntd_vars_all.csv')
head(prev_percent)
setwd("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/julie_work")
# We actually do this to test Nguyen results with our model, we do simulation with increasing some of
# our parameter values as disease control strategies.
prev_percent <- read.csv(file = 'gntd_vars_all.csv')
head(prev_percent)
head(prev_percent)
sch_mansoni_ind <- which(prev_percent$parasite_s == "S. mansoni")
sch_mansoni <- prev_percent[sch_mansoni_ind, ]
sch_mansoni <- sch_mansoni[-c(which(is.na(sch_mansoni$bio01))),]
sch_mansoni_sort <- sch_mansoni[order(sch_mansoni$bio01), ]
sch_mansoni_sort
sum(is.na(sch_mansoni_sort$bio01))
length(sch_mansoni_sort$bio01)
sch_mansoni_sort
sch_mansoni
sch_haematobium_ind <- which(prev_percent$parasite_s == "S. haematobium")
sch_haematobium <- prev_percent[sch_haematobium_ind, ]
sch_haematobium <- sch_haematobium[-c(which(is.na(sch_haematobium$bio01))),]
sch_haematobium
############# Nguyen's result plot ######################
temp <- c(15.127, 15.763, 16.525, 16.949, 17.458, 17.881, 18.305, 18.814, 19.322, 19.831, 20.508, 21.186, 21.949, 22.797, 23.644, 24.153, 24.746,  25.085, 25.593,  26.102,  26.61,  27.119,  27.542,  28.136,  28.898, 29.576, 30.339,  31.441, 32.458, 33.814, 34.619)
rate <- c(0.11, 0.172, 0.282, 0.373, 0.467, 0.533, 0.621,  0.712, 0.806, 0.884, 0.953, 0.984, 0.994,  0.95, 0.84, 0.765, 0.665, 0.586,  0.502, 0.439, 0.376, 0.301, 0.254, 0.197, 0.144, 0.11, 0.072, 0.038, 0.025, 0.009, 0.009)
# keep just a single curve
.x <- data.frame(temp, rate)
nguyen <- nls_multstart(rate~gaussian_1987(temp = temp, rmax, topt, a),
data = .x,
iter = c(4,4,4),
start_lower = get_start_vals(.x$temp, .x$rate, model_name = 'gaussian_1987') - 10,
start_upper = get_start_vals(.x$temp, .x$rate, model_name = 'gaussian_1987') + 10,
lower = get_lower_lims(.x$temp, .x$rate, model_name = 'gaussian_1987'),
upper = get_upper_lims(.x$temp, .x$rate, model_name = 'gaussian_1987'),
supp_errors = 'Y')
fn_nguyen <- function(x) augment(nguyen, newdata = x)
sch_mansoni_temp <- sch_mansoni$bio01
sch_mansoni_temp
fn_nguyen(sch_mansoni_temp)$.fitted
sch_mansoni_temp
fn_nguyen(data.frame(temp = sch_mansoni_temp))$.fitted
nguyen_pred_mansoni <- fn_nguyen(data.frame(temp = sch_mansoni$bio01))$.fitted
nguyen_pred_haematobium <- fn_nguyen(data.frame(temp = sch_haematobium$bio01))$.fitted
par_set_mansoni
par_set_mansoni.R
source("par_set_mansoni.R")
fn_beta_s(sch_mansoni$bio01)$.fitted
fn_beta_s(data.frame(temp = sch_mansoni$bio01))$.fitted
fn_mu_i_1(data.frame(temp = sch_mansoni$bio01))$.fitted
# This is analytic representation of R not value without control.
our_pred_mansoni <- (abs(lambda * fn_beta_s(data.frame(temp = sch_mansoni$bio01))$.fitted * h * fn_delta_e(data.frame(temp = sch_mansoni$bio01))$.fitted * nu_e
* fn_beta_h(data.frame(temp = sch_mansoni$bio01))$.fitted * fn_nu_c(data.frame(temp = sch_mansoni$bio01))$.fitted * fn_sigma_s(data.frame(temp = sch_mansoni$bio01))$.fitted/
(fn_mu_m(data.frame(temp = sch_mansoni$bio01))$.fitted * (mu_h + mu_p) * fn_mu_c(data.frame(temp = sch_mansoni$bio01))$.fitted * fn_mu_i_1(data.frame(temp = sch_mansoni$bio01))$.fitted *
(fn_sigma_s(data.frame(temp = sch_mansoni$bio01))$.fitted + fn_mu_i_1(data.frame(temp = sch_mansoni$bio01))$.fitted))))^(1/2)
source("par_set_haematobium.R")
our_pred_haematobium <- (abs(lambda * fn_beta_s(data.frame(temp = sch_haematobium$bio01))$.fitted * h * fn_delta_e(data.frame(temp = sch_haematobium$bio01))$.fitted * nu_e
* fn_beta_h(data.frame(temp = sch_haematobium$bio01))$.fitted * fn_nu_c(data.frame(temp = sch_haematobium$bio01))$.fitted * fn_sigma_s(data.frame(temp = sch_haematobium$bio01))$.fitted/
(fn_mu_m(data.frame(temp = sch_haematobium$bio01))$.fitted * (mu_h + mu_p) * fn_mu_c(data.frame(temp = sch_haematobium$bio01))$.fitted * fn_mu_i_1(data.frame(temp = sch_haematobium$bio01))$.fitted *
(fn_sigma_s(data.frame(temp = sch_haematobium$bio01))$.fitted + fn_mu_i_1(data.frame(temp = sch_haematobium$bio01))$.fitted))))^(1/2)
our_pred_haematobium
our_pred_mansoni
nguyen_pred_mansoni
nguyen_pred_haematobium
our_pred_mansoni <- our_pred_mansoni/max(our_pred_mansoni)
our_pred_mansoni
our_pred_haematobium <- our_pred_haematobium/max(our_pred_haematobium)
our_pred_haematobium
sch_mansoni$percent_pos
max(sch_mansoni$percent_pos)
sch_mansoni_results <- data.frame(sch_mansoni$percent_pos/max(sch_mansoni$percent_pos), sch_mansoni$bio01, our_pred_mansoni, nguyen_pred_mansoni)
size(sch_mansoni_results)
dim(sch_mansoni_results)
sch_haematobium_results <- data.frame(sch_haematobium$percent_pos/max(sch_haematobium$percent_pos), sch_haematobium$bio01, our_pred_haematobium, nguyen_pred_haematobium)
# Save the data frame to a CSV file
write.csv(sch_mansoni_results, file = "sch_mansoni_results.csv", row.names = FALSE)
# Save the data frame to a CSV file
write.csv(sch_mansoni_results, file = "sch_mansoni_results.csv", col.names = c("Prevalence", "Temperature", "Our Prediction", "Nguyen's Prediction"))
column_name <- c("Prevalence", "Temperature", "Our Prediction", "Nguyen's Prediction")
column_name
colnames(sch_mansoni_results) <- c("Prevalence", "Temperature", "Our Prediction", "Nguyen's Prediction")
sch_mansoni_results
# Save the data frame to a CSV file
write.csv(sch_mansoni_results, file = "sch_mansoni_results.csv", col.names = )
write.csv(sch_mansoni_results, file = "sch_mansoni_results.csv")
# Save the data frame to a CSV file
write.csv(sch_mansoni_results, file = "sch_mansoni_results.csv", row.names = FALSE)
sch_haematobium_results <- data.frame(sch_haematobium$percent_pos/max(sch_haematobium$percent_pos), sch_haematobium$bio01, our_pred_haematobium, nguyen_pred_haematobium)
colnames(sch_haematobium_results) <- c("Prevalence", "Temperature", "Our Prediction", "Nguyen's Prediction")
# Save the data frame to a CSV file
write.csv(sch_haematobium_results, file = "sch_haematobium_results.csv", row.names = FALSE)
nguyen_pred_mansoni <- fn_nguyen(data.frame(temp = sch_mansoni$bio01))$.fitted
nguyen_pred_mansoni <-nguyen_pred_mansoni/max(nguyen_pred_mansoni)
nguyen_pred_haematobium <- fn_nguyen(data.frame(temp = sch_haematobium$bio01))$.fitted
nguyen_pred_haematobium <- max(nguyen_pred_haematobium)
source("G:/.shortcut-targets-by-id/1e2xUwinp8NuntTAkfNCUIW_48Onf6MCd/Belmont Project/Thermal_sensitive_models/r_ibrahim_scripts/the_first_paper_code/may_5th_2023_ver_R_script/s.mansoni/julie_work/r_not_comparation.R")
